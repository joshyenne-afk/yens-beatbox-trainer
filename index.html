<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BEATBOX MASTERY - Complete Training System</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        :root {
            --bg-primary: #0A0A0B; --bg-secondary: #111113; --bg-tertiary: #1A1A1D; --bg-card: #151517;
            --text-primary: #FAFAFA; --text-secondary: #71717A; --text-muted: #52525B;
            --accent: #F97316; --accent-hover: #FB923C; --accent-glow: rgba(249, 115, 22, 0.3);
            --border: #27272A; --border-light: #3F3F46;
            --success: #22C55E; --success-glow: rgba(34, 197, 94, 0.3);
            --beginner: #22C55E; --intermediate: #EAB308; --advanced: #EF4444;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Space Grotesk', sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; padding: 16px; font-size: 13px; }
        .container { max-width: 1600px; margin: 0 auto; }
        .header { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 16px 24px; margin-bottom: 16px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px; }
        .logo { font-size: 22px; font-weight: 600; } .logo span { color: var(--accent); }
        .subtitle { font-size: 10px; letter-spacing: 0.1em; color: var(--text-muted); text-transform: uppercase; margin-top: 2px; }
        .mode-tabs { display: flex; background: var(--bg-tertiary); border-radius: 8px; padding: 3px; gap: 3px; }
        .mode-tab { padding: 8px 14px; background: transparent; border: none; border-radius: 6px; color: var(--text-secondary); font-family: inherit; font-size: 11px; font-weight: 500; cursor: pointer; transition: all 0.2s; }
        .mode-tab:hover { color: var(--text-primary); background: var(--bg-secondary); }
        .mode-tab.active { background: var(--accent); color: white; }
        .status-indicator { width: 8px; height: 8px; border-radius: 50%; background: var(--border); transition: all 0.3s; }
        .status-indicator.active { background: var(--accent); box-shadow: 0 0 12px var(--accent-glow); }
        .main-grid { display: grid; grid-template-columns: 280px 1fr; gap: 16px; align-items: start; }
        @media (max-width: 900px) { .main-grid { grid-template-columns: 1fr; } }
        .sidebar { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 16px; max-height: calc(100vh - 120px); overflow-y: auto; position: sticky; top: 16px; }
        .sidebar-section { margin-bottom: 20px; } .sidebar-section:last-child { margin-bottom: 0; }
        .sidebar-title { font-size: 9px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.12em; color: var(--text-muted); margin-bottom: 10px; padding-bottom: 6px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; }
        .difficulty-badge { font-size: 8px; padding: 2px 6px; border-radius: 4px; font-weight: 600; }
        .difficulty-badge.beginner { background: var(--beginner); color: #000; }
        .difficulty-badge.intermediate { background: var(--intermediate); color: #000; }
        .difficulty-badge.advanced { background: var(--advanced); color: white; }
        .sound-card-mini { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 10px; margin-bottom: 6px; cursor: pointer; transition: all 0.15s; display: flex; align-items: center; gap: 10px; }
        .sound-card-mini:hover { border-color: var(--accent); background: var(--bg-secondary); transform: translateX(2px); }
        .sound-phonetic-mini { font-size: 18px; font-weight: 700; color: var(--accent); font-family: 'JetBrains Mono', monospace; min-width: 45px; }
        .sound-info-mini { flex: 1; } .sound-name-mini { font-weight: 600; font-size: 11px; } .sound-desc-mini { font-size: 10px; color: var(--text-secondary); margin-top: 2px; }
        .main-content { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 24px; min-height: 500px; }
        .content-section { display: none; } .content-section.active { display: block; }
        .phase-nav { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
        .phase-btn { padding: 10px 16px; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; color: var(--text-secondary); font-family: inherit; font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s; }
        .phase-btn:hover { border-color: var(--border-light); color: var(--text-primary); }
        .phase-btn.active { background: var(--accent); border-color: var(--accent); color: white; }
        .phase-header { margin-bottom: 24px; } .phase-title { font-size: 24px; font-weight: 600; margin-bottom: 6px; }
        .phase-desc { font-size: 13px; color: var(--text-secondary); line-height: 1.5; max-width: 600px; }
        .selector-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; margin-bottom: 24px; }
        .selector-card { background: var(--bg-tertiary); border: 2px solid var(--border); border-radius: 10px; padding: 16px; cursor: pointer; transition: all 0.2s; text-align: center; position: relative; }
        .selector-card:hover { border-color: var(--border-light); transform: translateY(-2px); }
        .selector-card.selected { border-color: var(--accent); background: rgba(249, 115, 22, 0.1); }
        .selector-card.completed { border-color: var(--success); }
        .selector-card.completed::after { content: '✓'; position: absolute; top: 6px; right: 8px; color: var(--success); font-weight: 700; font-size: 12px; }
        .selector-phonetic { font-size: 28px; font-weight: 700; font-family: 'JetBrains Mono', monospace; color: var(--accent); margin-bottom: 4px; }
        .selector-name { font-size: 11px; color: var(--text-secondary); }
        .drill-card { background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%); border: 1px solid var(--border); border-radius: 12px; padding: 28px; }
        .drill-display { text-align: center; margin-bottom: 24px; }
        .drill-phonetic { font-size: 64px; font-weight: 700; font-family: 'JetBrains Mono', monospace; color: var(--accent); text-shadow: 0 0 40px var(--accent-glow); }
        .drill-name { font-size: 16px; color: var(--text-secondary); margin-top: 4px; }
        .drill-instruction { background: var(--bg-primary); border-radius: 10px; padding: 16px; margin: 20px auto; max-width: 550px; }
        .drill-instruction-title { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.1em; color: var(--accent); margin-bottom: 8px; }
        .drill-instruction-text { font-size: 13px; line-height: 1.6; }
        .drill-steps { margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border); }
        .drill-step { display: flex; gap: 10px; margin-bottom: 8px; font-size: 12px; color: var(--text-secondary); }
        .drill-step-num { background: var(--accent); color: white; width: 18px; height: 18px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600; flex-shrink: 0; }
        .youtube-link { display: inline-flex; align-items: center; gap: 6px; margin-top: 12px; padding: 8px 12px; background: #FF0000; color: white; border-radius: 6px; font-size: 11px; font-weight: 500; text-decoration: none; }
        .youtube-link:hover { background: #CC0000; }
        .beat-indicator { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap; }
        .beat-dot { width: 20px; height: 20px; border-radius: 50%; background: var(--bg-primary); border: 2px solid var(--border); transition: all 0.1s; }
        .beat-dot.active { background: var(--accent); border-color: var(--accent); box-shadow: 0 0 16px var(--accent-glow); transform: scale(1.2); }
        .drill-timer { text-align: center; margin-bottom: 20px; }
        .timer-display { font-size: 42px; font-weight: 700; font-family: 'JetBrains Mono', monospace; margin-bottom: 4px; }
        .timer-label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 16px; }
        .drill-controls { display: flex; justify-content: center; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; }
        .btn { padding: 10px 18px; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary); font-family: inherit; font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; gap: 8px; }
        .btn:hover { background: var(--bg-secondary); border-color: var(--border-light); }
        .btn.primary { background: var(--accent); border-color: var(--accent); color: white; }
        .btn.primary:hover { background: var(--accent-hover); }
        .btn.large { padding: 14px 28px; font-size: 15px; border-radius: 10px; }
        .tempo-control { display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 20px; }
        .tempo-label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; }
        .tempo-slider { -webkit-appearance: none; width: 140px; height: 4px; background: var(--border); border-radius: 2px; outline: none; }
        .tempo-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 14px; height: 14px; background: var(--accent); border-radius: 50%; cursor: pointer; border: 2px solid var(--bg-primary); }
        .tempo-value { font-family: 'JetBrains Mono', monospace; font-size: 12px; min-width: 55px; }
        .drill-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 20px; }
        .stat-card { background: var(--bg-primary); border-radius: 8px; padding: 14px; text-align: center; }
        .stat-value { font-size: 22px; font-weight: 700; font-family: 'JetBrains Mono', monospace; }
        .stat-label { font-size: 9px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-top: 4px; }
        .combo-display { display: flex; justify-content: center; align-items: center; gap: 16px; margin-bottom: 24px; flex-wrap: wrap; }
        .combo-phonetic { font-size: 48px; font-weight: 700; font-family: 'JetBrains Mono', monospace; color: var(--accent); transition: all 0.2s; }
        .combo-phonetic.current { text-shadow: 0 0 30px var(--accent-glow); transform: scale(1.15); }
        .combo-phonetic.inactive { color: var(--text-muted); opacity: 0.4; }
        .combo-arrow { font-size: 28px; color: var(--text-muted); }
        .triplet-display { display: flex; justify-content: center; align-items: center; gap: 16px; margin-bottom: 24px; flex-wrap: wrap; }
        .triplet-phonetic { font-size: 42px; font-weight: 700; font-family: 'JetBrains Mono', monospace; color: var(--accent); transition: all 0.15s; }
        .triplet-phonetic.current { text-shadow: 0 0 30px var(--accent-glow); transform: scale(1.1); }
        .triplet-phonetic.inactive { color: var(--text-muted); opacity: 0.4; }
        .transport { display: flex; align-items: center; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
        .transport-controls { display: flex; gap: 8px; }
        .pattern-info { background: var(--bg-tertiary); border-radius: 10px; padding: 14px; margin-bottom: 16px; border: 1px solid var(--border); }
        .pattern-title { font-size: 16px; font-weight: 600; margin-bottom: 4px; }
        .pattern-description { font-size: 12px; color: var(--text-secondary); line-height: 1.5; }
        .phonetic-guide { background: linear-gradient(135deg, rgba(249, 115, 22, 0.15), rgba(249, 115, 22, 0.05)); border: 1px solid var(--accent); border-radius: 10px; padding: 14px; margin-bottom: 16px; text-align: center; }
        .phonetic-text { font-size: 20px; font-weight: 700; font-family: 'JetBrains Mono', monospace; color: var(--accent); letter-spacing: 3px; }
        .phonetic-help { font-size: 10px; color: var(--text-secondary); margin-top: 4px; }
        .sequencer { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 10px; padding: 16px; overflow-x: auto; }
        .track { display: grid; grid-template-columns: 80px repeat(16, 1fr); gap: 3px; align-items: center; margin-bottom: 4px; }
        .track:last-child { margin-bottom: 0; }
        .track-label { font-size: 9px; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-muted); display: flex; flex-direction: column; gap: 1px; }
        .track-name { font-weight: 600; color: var(--text-secondary); }
        .track-phonetic { font-size: 12px; font-weight: 700; color: var(--accent); font-family: 'JetBrains Mono', monospace; }
        .step { aspect-ratio: 1; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; transition: all 0.1s; min-width: 24px; }
        .step:hover { border-color: var(--accent); }
        .step.active { background: var(--accent); border-color: var(--accent); }
        .step.playing { box-shadow: 0 0 0 2px var(--accent-glow); transform: scale(1.05); }
        .step:nth-child(5n+2) { margin-left: 2px; }
        .pattern-search { width: 100%; padding: 8px 10px; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; font-size: 12px; font-family: inherit; color: var(--text-primary); margin-bottom: 10px; }
        .pattern-search::placeholder { color: var(--text-muted); }
        .pattern-search:focus { outline: none; border-color: var(--accent); }
        .genre-filters { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 10px; }
        .genre-tag { padding: 4px 8px; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 4px; font-size: 9px; color: var(--text-secondary); cursor: pointer; transition: all 0.2s; }
        .genre-tag:hover, .genre-tag.active { background: var(--accent); border-color: var(--accent); color: white; }
        .pattern-list { max-height: 300px; overflow-y: auto; }
        .pattern-item { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; padding: 8px 10px; margin-bottom: 4px; cursor: pointer; transition: all 0.2s; }
        .pattern-item:hover { border-color: var(--border-light); transform: translateX(2px); }
        .pattern-item.active { background: rgba(249, 115, 22, 0.1); border-color: var(--accent); }
        .pattern-name { font-weight: 600; font-size: 11px; }
        .pattern-meta { font-size: 9px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 2px; }
        .guru-header { margin-bottom: 16px; }
        .guru-title { font-size: 20px; font-weight: 600; margin-bottom: 4px; }
        .guru-desc { font-size: 12px; color: var(--text-secondary); line-height: 1.5; }
        .guru-suggestions { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 16px; }
        .guru-suggestion { padding: 6px 10px; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 6px; font-size: 11px; color: var(--text-secondary); cursor: pointer; transition: all 0.2s; }
        .guru-suggestion:hover { border-color: var(--accent); color: var(--accent); }
        .chat-container { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; }
        .chat-messages { height: 350px; overflow-y: auto; padding: 16px; display: flex; flex-direction: column; gap: 12px; }
        .chat-message { max-width: 85%; padding: 10px 14px; border-radius: 10px; font-size: 13px; line-height: 1.5; white-space: pre-wrap; }
        .chat-message.user { align-self: flex-end; background: var(--accent); color: white; }
        .chat-message.assistant { align-self: flex-start; background: var(--bg-primary); }
        .chat-input-container { display: flex; gap: 10px; padding: 12px; border-top: 1px solid var(--border); }
        .chat-input { flex: 1; padding: 10px 12px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; font-size: 13px; font-family: inherit; color: var(--text-primary); }
        .chat-input:focus { outline: none; border-color: var(--accent); }
        .chat-send { padding: 10px 16px; background: var(--accent); border: none; border-radius: 8px; color: white; font-family: inherit; font-size: 13px; font-weight: 500; cursor: pointer; }
        .chat-send:hover { background: var(--accent-hover); }
        .api-key-input { width: 100%; padding: 8px 10px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 6px; font-size: 11px; font-family: 'JetBrains Mono', monospace; color: var(--text-primary); margin-bottom: 12px; }
        .api-key-input:focus { outline: none; border-color: var(--accent); }
        .status-message { position: fixed; bottom: 20px; right: 20px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px; padding: 12px 16px; font-size: 12px; display: none; z-index: 1000; }
        .status-message.show { display: block; }
        .status-message.success { border-color: var(--success); color: var(--success); }
        ::-webkit-scrollbar { width: 6px; } ::-webkit-scrollbar-track { background: var(--bg-tertiary); border-radius: 3px; } ::-webkit-scrollbar-thumb { background: var(--border-light); border-radius: 3px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div><div class="logo">BEATBOX<span>MASTERY</span></div><div class="subtitle">Progressive Training System</div></div>
            <div style="display: flex; align-items: center; gap: 12px;">
                <div class="mode-tabs">
                    <button class="mode-tab active" data-mode="training">Training</button>
                    <button class="mode-tab" data-mode="patterns">Patterns</button>
                    <button class="mode-tab" data-mode="guru">AI Guru</button>
                </div>
                <div class="status-indicator" id="statusIndicator"></div>
            </div>
        </div>
        <div class="main-grid">
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title">Beginner Sounds<span class="difficulty-badge beginner">Start Here</span></div>
                    <div id="beginnerSounds"></div>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Intermediate<span class="difficulty-badge intermediate">Level Up</span></div>
                    <div id="intermediateSounds"></div>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Advanced<span class="difficulty-badge advanced">Pro</span></div>
                    <div id="advancedSounds"></div>
                </div>
                <div class="sidebar-section" id="patternSidebar">
                    <div class="sidebar-title">Pattern Library</div>
                    <input type="text" class="pattern-search" id="patternSearch" placeholder="Search patterns..." />
                    <div class="genre-filters" id="genreFilters"></div>
                    <div class="pattern-list" id="patternList"></div>
                </div>
            </div>
            <div class="main-content">
                <div class="content-section active" id="trainingSection">
                    <div class="phase-nav">
                        <button class="phase-btn active" data-phase="1">Phase 1: Isolation</button>
                        <button class="phase-btn" data-phase="2">Phase 2: Two-Sound</button>
                        <button class="phase-btn" data-phase="3">Phase 3: Triplets</button>
                    </div>
                    <div class="phase-content active" id="phase1">
                        <div class="phase-header"><div class="phase-title">Sound Isolation</div><div class="phase-desc">Master each sound individually. One sound, every beat. Timer optional—skip ahead anytime.</div></div>
                        <div class="selector-grid" id="phase1Sounds"></div>
                        <div class="drill-card" id="drillCard" style="display: none;">
                            <div class="drill-display"><div class="drill-phonetic" id="drillPhonetic">{ t }</div><div class="drill-name" id="drillName">Hi-Hat</div></div>
                            <div class="drill-instruction"><div class="drill-instruction-title">Technique</div><div class="drill-instruction-text" id="drillInstruction"></div><div class="drill-steps" id="drillSteps"></div></div>
                            <a class="youtube-link" id="youtubeLink" href="#" target="_blank" style="display: none; margin: 12px auto;">▶ Watch Tutorial</a>
                            <div class="beat-indicator" id="beatIndicator"><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div></div>
                            <div class="drill-timer"><div class="timer-display" id="timerDisplay">1:00</div><div class="timer-label">Remaining (optional)</div></div>
                            <div class="drill-controls">
                                <button class="btn primary" id="startDrillBtn" onclick="startDrill()">▶ Start Drill</button>
                                <button class="btn" id="stopDrillBtn" onclick="stopDrill()" style="display: none;">■ Stop</button>
                                <button class="btn" onclick="markComplete()">✓ Mark Complete</button>
                            </div>
                            <div class="tempo-control" style="justify-content: center; margin-top: 16px;"><span class="tempo-label">Tempo</span><input type="range" class="tempo-slider" id="drillTempoSlider" min="40" max="140" value="60" /><span class="tempo-value" id="drillTempoValue">60 BPM</span></div>
                            <div class="drill-stats"><div class="stat-card"><div class="stat-value" id="statBeats">0</div><div class="stat-label">Beats</div></div><div class="stat-card"><div class="stat-value" id="statAccuracy">--%</div><div class="stat-label">Accuracy</div></div><div class="stat-card"><div class="stat-value" id="statStreak">0</div><div class="stat-label">Streak</div></div></div>
                        </div>
                    </div>
                    <div class="phase-content" id="phase2" style="display: none;">
                        <div class="phase-header"><div class="phase-title">Two-Sound Combinations</div><div class="phase-desc">Bridge between isolation and full patterns. Practice transitions until automatic.</div></div>
                        <div class="selector-grid" id="phase2Combos"></div>
                        <div class="drill-card" id="comboCard" style="display: none;">
                            <div class="combo-display"><div class="combo-sound"><div class="combo-phonetic" id="comboSound1">B</div></div><div class="combo-arrow">→</div><div class="combo-sound"><div class="combo-phonetic" id="comboSound2">t</div></div></div>
                            <div class="beat-indicator" id="comboBeatIndicator"><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div></div>
                            <div class="drill-timer"><div class="timer-display" id="comboTimerDisplay">1:00</div><div class="timer-label">Remaining (optional)</div></div>
                            <div class="drill-controls">
                                <button class="btn primary" id="startComboBtn" onclick="startComboDrill()">▶ Start Drill</button>
                                <button class="btn" id="stopComboBtn" onclick="stopComboDrill()" style="display: none;">■ Stop</button>
                                <button class="btn" onclick="markComboComplete()">✓ Mark Complete</button>
                            </div>
                            <div class="tempo-control" style="justify-content: center; margin-top: 16px;"><span class="tempo-label">Tempo</span><input type="range" class="tempo-slider" id="comboTempoSlider" min="40" max="120" value="60" /><span class="tempo-value" id="comboTempoValue">60 BPM</span></div>
                            <div class="drill-stats"><div class="stat-card"><div class="stat-value" id="comboStatBeats">0</div><div class="stat-label">Cycles</div></div><div class="stat-card"><div class="stat-value" id="comboStatAccuracy">--%</div><div class="stat-label">Accuracy</div></div><div class="stat-card"><div class="stat-value" id="comboStatStreak">0</div><div class="stat-label">Streak</div></div></div>
                        </div>
                    </div>
                    <div class="phase-content" id="phase3" style="display: none;">
                        <div class="phase-header"><div class="phase-title">Three-Sound Triplets</div><div class="phase-desc">"Boots and cats" = B-t-K. The foundation of all drum patterns.</div></div>
                        <div class="selector-grid" id="phase3Triplets"></div>
                        <div class="drill-card" id="tripletCard" style="display: none;">
                            <div class="triplet-display"><div class="triplet-sound"><div class="triplet-phonetic" id="tripletSound1">B</div></div><div class="combo-arrow">→</div><div class="triplet-sound"><div class="triplet-phonetic" id="tripletSound2">t</div></div><div class="combo-arrow">→</div><div class="triplet-sound"><div class="triplet-phonetic" id="tripletSound3">K</div></div></div>
                            <div class="beat-indicator" id="tripletBeatIndicator"><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div><div class="beat-dot"></div></div>
                            <div class="drill-timer"><div class="timer-display" id="tripletTimerDisplay">1:00</div><div class="timer-label">Remaining (optional)</div></div>
                            <div class="drill-controls">
                                <button class="btn primary" id="startTripletBtn" onclick="startTripletDrill()">▶ Start Drill</button>
                                <button class="btn" id="stopTripletBtn" onclick="stopTripletDrill()" style="display: none;">■ Stop</button>
                                <button class="btn" onclick="markTripletComplete()">✓ Mark Complete</button>
                            </div>
                            <div class="tempo-control" style="justify-content: center; margin-top: 16px;"><span class="tempo-label">Tempo</span><input type="range" class="tempo-slider" id="tripletTempoSlider" min="40" max="120" value="50" /><span class="tempo-value" id="tripletTempoValue">50 BPM</span></div>
                            <div class="drill-stats"><div class="stat-card"><div class="stat-value" id="tripletStatBeats">0</div><div class="stat-label">Cycles</div></div><div class="stat-card"><div class="stat-value" id="tripletStatAccuracy">--%</div><div class="stat-label">Accuracy</div></div><div class="stat-card"><div class="stat-value" id="tripletStatStreak">0</div><div class="stat-label">Streak</div></div></div>
                        </div>
                    </div>
                </div>
                <div class="content-section" id="patternsSection">
                    <div class="transport">
                        <div class="transport-controls"><button class="btn" id="playBtn">▶ Play</button><button class="btn" id="stopBtn">■ Stop</button><button class="btn" id="clearBtn">✕ Clear</button></div>
                        <div class="tempo-control"><span class="tempo-label">Tempo</span><input type="range" class="tempo-slider" id="tempoSlider" min="40" max="180" value="90" /><span class="tempo-value" id="tempoValue">90 BPM</span></div>
                    </div>
                    <div class="pattern-info" id="patternInfo"><div class="pattern-title" id="patternTitle">Select a Pattern</div><div class="pattern-description" id="patternDescription">Choose from sidebar or create your own</div></div>
                    <div class="phonetic-guide"><div class="phonetic-text" id="phoneticGuide">B - t - K - t</div><div class="phonetic-help">Speak this rhythm slowly, then speed up</div></div>
                    <div class="sequencer" id="sequencer">
                        <div class="track" data-instrument="kick"><div class="track-label"><span class="track-name">Kick</span><span class="track-phonetic">{ B }</span></div></div>
                        <div class="track" data-instrument="snare"><div class="track-label"><span class="track-name">Snare</span><span class="track-phonetic">{ K }</span></div></div>
                        <div class="track" data-instrument="hihat"><div class="track-label"><span class="track-name">HiHat</span><span class="track-phonetic">{ t }</span></div></div>
                        <div class="track" data-instrument="openhat"><div class="track-label"><span class="track-name">Open</span><span class="track-phonetic">{ ts }</span></div></div>
                    </div>
                </div>
                <div class="content-section" id="guruSection">
                    <div class="guru-header"><div class="guru-title">Beatbox Guru</div><div class="guru-desc">AI instructor grounded in USC SAIL beatbox research.</div></div>
                    <input type="password" class="api-key-input" id="geminiApiKey" placeholder="Paste Gemini API key (stored locally only)" />
                    <div class="guru-suggestions">
                        <button class="guru-suggestion" onclick="sendGuruMessage('How do I do a lip roll?')">Lip roll technique?</button>
                        <button class="guru-suggestion" onclick="sendGuruMessage('Explain the inward K snare technique')">Inward K snare?</button>
                        <button class="guru-suggestion" onclick="sendGuruMessage('What is circular breathing?')">Circular breathing?</button>
                        <button class="guru-suggestion" onclick="sendGuruMessage('Give me a 5-minute practice routine')">5-min routine</button>
                    </div>
                    <div class="chat-container">
                        <div class="chat-messages" id="chatMessages"><div class="chat-message assistant">Hello! I'm the Beatbox Guru. Ask me anything about vocal percussion.</div></div>
                        <div class="chat-input-container"><input type="text" class="chat-input" id="chatInput" placeholder="Ask about technique..." onkeypress="if(event.key==='Enter')sendGuruMessage()" /><button class="chat-send" onclick="sendGuruMessage()">Send</button></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="status-message" id="statusMessage"></div>
<script>
const STEPS = 16, instruments = ['kick', 'snare', 'hihat', 'openhat'], DRILL_DURATION = 60;
const soundData = {
    hihat: { id: 'hihat', phonetic: '{ t }', name: 'Hi-Hat (Closed)', difficulty: 'beginner', instruction: 'Tongue tip behind front teeth. Make "t" from "hat"—consonant only, no voice.', steps: ['Position tongue tip behind front teeth', 'Build slight pressure', 'Release with quick "t" burst', 'Keep SHORT and crisp'], youtubeUrl: 'https://www.youtube.com/results?search_query=beatbox+hi+hat+tutorial' },
    snare: { id: 'snare', phonetic: '{ K }', name: 'K-Snare', difficulty: 'beginner', instruction: 'Hard "K" as in "kit"—the "cats" in "boots and cats". Back of tongue to soft palate.', steps: ['Press back of tongue against soft palate', 'Build pressure behind seal', 'Release sharply with emphasis', 'Should click, not be breathy'], youtubeUrl: 'https://www.youtube.com/results?search_query=beatbox+k+snare+tutorial' },
    kick: { id: 'kick', phonetic: '{ B }', name: 'Classic Kick', difficulty: 'beginner', instruction: 'Whisper "boo" (no voice). Isolate just the "B" with heavy emphasis. Lips closed, one burst.', steps: ['Close lips tightly, build pressure', 'Close epiglottis (hold breath)', 'Release lips in one explosive burst', 'Let lips vibrate briefly (<0.1 sec)'], youtubeUrl: 'https://www.youtube.com/results?search_query=beatbox+kick+drum+tutorial' },
    openhat: { id: 'openhat', phonetic: '{ ts }', name: 'Hi-Hat (Open)', difficulty: 'beginner', instruction: 'Start with { t }, extend with "s" sound. Open lips slightly for more air.', steps: ['Begin with standard { t } position', 'Extend into sustained "sss"', 'Control duration for decay'], youtubeUrl: 'https://www.youtube.com/results?search_query=beatbox+open+hi+hat' },
    pfsnare: { id: 'pfsnare', phonetic: '{ Pf }', name: 'PF-Snare (Classic)', difficulty: 'intermediate', instruction: 'Say "poof" without the "oo"—zero gap. Heavy attack, airy decay. DJ-style backbone.', steps: ['Press lips for P', 'Build pressure (less than kick)', 'Release P directly into F', 'Upper incisors meet lower lip for F'], youtubeUrl: 'https://www.youtube.com/results?search_query=beatbox+pf+snare+tutorial' },
    inwardk: { id: 'inwardk', phonetic: '{ ^K }', name: 'Inward K-Snare', difficulty: 'intermediate', instruction: 'Kenny Muhammad signature. Inhale while snaring—allows breathing while beatboxing.', steps: ['Touch tongue tip to roof behind T', 'Seal sides against palate', 'Create low pressure by inhaling attempt', 'Drop middle tongue, maintain tip/back seal', 'Continue inhale for "shh" tail'], youtubeUrl: 'https://www.youtube.com/results?search_query=beatbox+inward+k+snare' },
    kick808: { id: 'kick808', phonetic: '{ U }', name: '808 Kick / Throat Bass', difficulty: 'advanced', instruction: 'Close epiglottis, vocalize while closed. Sound from vocal cords but trapped.', steps: ['Close epiglottis (shut airway)', 'Keep it closed firmly', 'Vocalize while epiglottis shut', 'Place mic on throat for effect'], youtubeUrl: 'https://www.youtube.com/results?search_query=beatbox+throat+bass+808' }
};
const comboData = {
    'kick-hihat': { sounds: ['kick', 'hihat'], display: ['B', 't'], name: 'Kick → Hi-Hat' },
    'hihat-snare': { sounds: ['hihat', 'snare'], display: ['t', 'K'], name: 'Hi-Hat → Snare' },
    'kick-snare': { sounds: ['kick', 'snare'], display: ['B', 'K'], name: 'Kick → Snare' },
    'kick-pfsnare': { sounds: ['kick', 'pfsnare'], display: ['B', 'Pf'], name: 'Kick → PF-Snare' },
    'hihat-pfsnare': { sounds: ['hihat', 'pfsnare'], display: ['t', 'Pf'], name: 'Hi-Hat → PF' },
    'kick-openhat': { sounds: ['kick', 'openhat'], display: ['B', 'ts'], name: 'Kick → Open Hat' }
};
const tripletData = {
    'boots-cats': { sounds: ['kick', 'hihat', 'snare'], display: ['B', 't', 'K'], name: '"Boots and Cats"' },
    'kick-hat-pf': { sounds: ['kick', 'hihat', 'pfsnare'], display: ['B', 't', 'Pf'], name: 'Kick-Hat-PF' },
    'kick-snare-hat': { sounds: ['kick', 'snare', 'hihat'], display: ['B', 'K', 't'], name: 'Kick-Snare-Hat' },
    'hat-kick-snare': { sounds: ['hihat', 'kick', 'snare'], display: ['t', 'B', 'K'], name: 'Hat-Kick-Snare' },
    'kick-openhat-snare': { sounds: ['kick', 'openhat', 'snare'], display: ['B', 'ts', 'K'], name: 'With Open Hat' },
    'double-kick-snare': { sounds: ['kick', 'kick', 'snare'], display: ['B', 'B', 'K'], name: 'Double Kick' }
};
